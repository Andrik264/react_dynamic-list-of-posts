(this["webpackJsonpreact_dynamic-list-of-posts"]=this["webpackJsonpreact_dynamic-list-of-posts"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var c=n(10),a=n.n(c),s=n(3),r=n(1),i=(n(16),n(17),n(18),n(4)),o=n(2),u=n.n(o),l="https://mate.academy/students-api";function j(e){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(u.a.mark((function e(t){var n,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=6;break}throw c=n.status,a=n.statusText,new Error("".concat(c," - ").concat(a));case 6:return e.abrupt("return",n.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b="".concat(l,"/posts"),m=function(e){return"".concat(b,"?userId=").concat(e)};function p(){return(p=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j(t>0?m(t):b));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j("".concat(b,"/").concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=n(0),x=function(e){var t=e.selectedUser,n=e.selectedPostId,c=e.onPostSelect,a=Object(r.useState)([]),i=Object(s.a)(a,2),o=i[0],u=i[1];return Object(r.useEffect)((function(){(function(e){return p.apply(this,arguments)})(t).then((function(e){return u(e)})).catch((function(e){throw new Error(e)}))}),[t]),Object(O.jsxs)("div",{className:"PostsList",children:[Object(O.jsx)("h2",{children:"Posts:"}),Object(O.jsx)("ul",{className:"PostsList__list","data-cy":"postDetails",children:o.map((function(e){return Object(O.jsxs)("li",{className:"PostsList__item",children:[Object(O.jsxs)("div",{children:[Object(O.jsxs)("b",{children:["[User #",e.userId,"] :\xa0"]}),e.title]}),Object(O.jsx)("button",{type:"button",className:"PostsList__button button",onClick:function(){return c(e.id)},children:n===e.id?"Close":"Open"})]},e.id)}))})]})},v=n(11),_=n(5),N=n(8),w=(n(21),function(e){var t=e.addNewComment,n=Object(r.useState)({name:"",email:"",body:""}),c=Object(s.a)(n,2),a=c[0],i=c[1],o=function(e,t){var n=Object(_.a)(Object(_.a)({},a),{},Object(N.a)({},e,t));i(n)};return Object(O.jsxs)("form",{className:"NewCommentForm",method:"POST",onSubmit:function(e){e.preventDefault();var n=Object(_.a)(Object(_.a)({},a),{},{id:Math.random(),postId:Math.random()+1,createdAt:new Date,updatedAt:new Date});t(n)},children:[Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("input",{type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:a.name,onChange:function(e){var t=e.target,n=t.name,c=t.value;return o(n,c)}})}),Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("input",{type:"text",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:a.email,onChange:function(e){var t=e.target,n=t.name,c=t.value;return o(n,c)}})}),Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("textarea",{name:"body",placeholder:"Type comment here",className:"NewCommentForm__input",value:a.body,onChange:function(e){var t=e.target,n=t.name,c=t.value;return o(n,c)}})}),Object(O.jsx)("button",{type:"submit",className:"NewCommentForm__submit-button button",children:"Add a comment"})]})});n(22);function y(e){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j("".concat(l,"/comments?postId=").concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=function(e){var t=e.selectedPostId,n=Object(r.useState)(null),c=Object(s.a)(n,2),a=c[0],o=c[1],l=Object(r.useState)([]),j=Object(s.a)(l,2),d=j[0],b=j[1],m=Object(r.useState)(!0),p=Object(s.a)(m,2),h=p[0],x=p[1];Object(r.useEffect)((function(){var e=function(){var e=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([f(t),y(t)]));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().then((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1];o(n),b(c)}))}),[t]);var N=Object(r.useCallback)((function(e){var t=d.filter((function(t){return t.id!==e}));b(t)}),[d]),P=Object(r.useCallback)((function(e){if(function(e,t){return!e.map((function(e){return e.id})).includes(t.id)}(d,e))b([e].concat(Object(v.a)(d)));else{var t=Object(_.a)(Object(_.a)({},e),{},{id:e.id+1});P(t)}}),[d]);return a&&Object(O.jsxs)("div",{className:"PostDetails",children:[Object(O.jsx)("h2",{children:"Post details:"}),Object(O.jsx)("section",{className:"PostDetails__post",children:Object(O.jsx)("p",{children:a.body})}),d.length&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("section",{className:"PostDetails__comments",children:[Object(O.jsxs)("button",{type:"button",className:"button",onClick:function(){return x(!h)},children:[h?"Hide":"Show","\xa0",d.length," ","comments"]}),h&&Object(O.jsx)("ul",{className:"PostDetails__list","data-cy":"postDetails",children:d.map((function(e){return Object(O.jsxs)("li",{className:"PostDetails__list-item",children:[Object(O.jsx)("button",{type:"button",className:"PostDetails__remove-button button",onClick:function(){return N(e.id)},children:"X"}),Object(O.jsx)("p",{children:e.body})]},e.id)}))})]}),Object(O.jsx)("section",{children:Object(O.jsx)("div",{className:"PostDetails__form-wrapper",children:Object(O.jsx)(w,{addNewComment:P})})})]})]})};function k(){return(k=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j("".concat(l,"/users")));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(0),i=Object(s.a)(a,2),o=i[0],u=i[1],l=Object(r.useState)(null),j=Object(s.a)(l,2),d=j[0],b=j[1];return Object(r.useEffect)((function(){(function(){return k.apply(this,arguments)})().then((function(e){return c(e)}))}),[]),Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)("header",{className:"App__header",children:Object(O.jsxs)("label",{children:["Select a user: \xa0",Object(O.jsxs)("select",{className:"App__user-selector",onChange:function(e){return u(+e.target.value)},children:[Object(O.jsx)("option",{value:"0",selected:!0,children:"All users"}),n.map((function(e){return Object(O.jsxs)("option",{value:e.id,children:[e.name,"(#",e.id,")"]},e.id)}))]})]})}),Object(O.jsxs)("main",{className:"App__main",children:[Object(O.jsx)("div",{className:"App__sidebar",children:Object(O.jsx)(x,{selectedUser:o,selectedPostId:d,onPostSelect:b})}),Object(O.jsx)("div",{className:"App__content",children:d&&Object(O.jsx)(C,{selectedPostId:d})})]})]})};a.a.render(Object(O.jsx)(S,{}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.d5c7a98a.chunk.js.map